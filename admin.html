<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f8;
  margin:0;
  padding:20px;
}
.card{
  background:#fff;
  padding:20px;
  margin-bottom:20px;
  border-radius:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.1);
}
h1,h2{
  text-align:center;
}
button{
  width:100%;
  padding:14px;
  margin:8px 0;
  border:none;
  border-radius:8px;
  font-size:16px;
  color:#fff;
}
.blue{background:#3b82f6;}
.red{background:#ef4444;}
.green{background:#22c55e;}
.gray{background:#6b7280;}
input{
  width:100%;
  padding:12px;
  margin:6px 0;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
}
.row{
  display:flex;
  justify-content:space-between;
  margin:6px 0;
}
.hide{display:none;}
</style>
</head>

<body>

<h1>Admin Panel</h1>

<!-- LOGIN -->
<div class="card" id="loginBox">
  <h2>Admin Login</h2>
  <input type="password" id="loginPass" placeholder="Enter Password">
  <button class="blue" onclick="login()">Login</button>
</div>

<!-- PANEL -->
<div id="panel" class="hide">

  <div class="card">
    <button class="blue" onclick="loadBets()">Refresh Bets</button>
    <button class="red" onclick="resetBets()">Reset All Bets</button>
  </div>

  <div class="card">
    <button class="green" onclick="declareResult()">Declare Result</button>
    <button class="gray" onclick="viewResult()">View Result</button>
  </div>

  <div class="card">
    <h2>Bet Summary</h2>
    <div id="betList"></div>
  </div>

  <div class="card">
    <h2>Profit Calculation</h2>
    <div class="row"><b>Total Bet</b><span id="totalBet">₹0</span></div>
    <div class="row"><b>Winning Payout</b><span id="payout">₹0</span></div>
    <div class="row"><b>Profit</b><span id="profit">₹0</span></div>
  </div>

  <!-- CHANGE PASSWORD -->
  <div class="card">
    <h2>Change Password</h2>
    <input type="password" id="oldPass" placeholder="Old Password">
    <input type="password" id="newPass" placeholder="New Password">
    <input type="password" id="confirmPass" placeholder="Confirm Password">
    <button class="green" onclick="changePassword()">Update Password</button>
  </div>

</div>

<script>
// ===== INITIAL PASSWORD =====
if(!localStorage.getItem("adminPassword")){
  localStorage.setItem("adminPassword","1234"); // default
}

// ===== LOGIN =====
function login(){
  let p=document.getElementById("loginPass").value;
  if(p===localStorage.getItem("adminPassword")){
    document.getElementById("loginBox").classList.add("hide");
    document.getElementById("panel").classList.remove("hide");
    loadBets();
  }else{
    alert("Wrong Password");
  }
}

// ===== CHANGE PASSWORD =====
function changePassword(){
  let oldP=document.getElementById("oldPass").value;
  let newP=document.getElementById("newPass").value;
  let cP=document.getElementById("confirmPass").value;

  if(oldP!==localStorage.getItem("adminPassword")){
    alert("Old password wrong");
    return;
  }
  if(newP.length<4){
    alert("Minimum 4 characters");
    return;
  }
  if(newP!==cP){
    alert("Password not matched");
    return;
  }
  localStorage.setItem("adminPassword",newP);
  alert("Password Updated");
  document.getElementById("oldPass").value="";
  document.getElementById("newPass").value="";
  document.getElementById("confirmPass").value="";
}

// ===== BETS =====
function loadBets(){
  let bets=JSON.parse(localStorage.getItem("bets"))||{};
  let box=document.getElementById("betList");
  box.innerHTML="";
  let total=0;

  for(let n in bets){
    total+=bets[n];
    box.innerHTML+=`<div class="row"><span>Number ${n}</span><span>₹${bets[n]}</span></div>`;
  }
  document.getElementById("totalBet").innerText="₹"+total;
}

function resetBets(){
  if(confirm("Reset all bets?")){
    localStorage.removeItem("bets");
    localStorage.removeItem("winningNumber");
    loadBets();
  }
}

// ===== RESULT =====
function declareResult(){
  let n=prompt("Enter winning number (1-100)");
  n=parseInt(n);
  if(n>=1 && n<=100){
    localStorage.setItem("winningNumber",n);
    alert("Result Declared: "+n);
  }else{
    alert("Invalid Number");
  }
}

function viewResult(){
  window.location="result.html";
}
</script>

</body>
</html>